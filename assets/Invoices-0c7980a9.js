import{d as f,o as u,h as v,i as p,j as b,l as y,C as c,A as k,b as o,f as d,m as l,w as i,e as h,t as r,g as m,c as A,u as g,a as C}from"./index-2c09f05d.js";import{_ as w}from"./CAlert-6c56d511.js";import{_ as V}from"./DynamicTable-69364c84.js";const I={class:"pricing-header p-3 pb-md-4 mx-auto text-center"},N={class:"row"},R=o("div",{class:"col"},[o("div",{class:"mb-3 row text-start"},[o("div",{class:"col-sm-10"},[o("span",{class:"display-6 fw-normal"},"Invoices")])])],-1),M={class:"col text-end"},S=o("span",{class:"material-icons"},"add",-1),D={class:"text-center"},T=o("div",{class:"spinner-grow",role:"status"},[o("span",{class:"visually-hidden"},"Loading...")],-1),B={class:"d-flex d-flex p-3 border-top"},F=o("label",{class:"form-label me-2"},"From",-1),U=o("label",{class:"form-label form-label me-2"},"to",-1),L={key:0,class:"row"},O={class:"col text-start"},$={class:"col"},j={class:"col"},E={data:function(){return{items:[],allowaction:!0,columns:[{name:"invoiceNumber",show:!0},{name:"purchaseDate",show:!0,type:"date"},{name:"customer",show:!0},{name:"products",show:!0},{name:"weight",show:!0,type:"amount"},{name:"amount",show:!0,type:"amount"}],actions:[{identifier:"viewClick",materialicon:"print",title:"View and Print Invoice"}],actionMapper:[],loadingmsg:"",alertmsg:"",alertmode:"",searchkeyword:"",datefrom:"",dateto:"",totals:{}}},mounted:function(){this.loadItems()},methods:{loadItems:function(n){n&&n.preventDefault();var t=this,s={};t.loadingmsg="Fetching invoices..",t.totals={weight:0,amount:0},y.list(this.datefrom,this.dateto,this.searchkeyword).then(a=>{_.each(a,function(e){s[e.invoiceNumber]=t.actions,e.products=e.items.length,e.weight=e.totals?e.totals.weight:0,e.amount=e.totals?e.totals.totalAmount:0,e.weight&&e.amount&&(t.totals.weight+=e.weight,t.totals.amount+=e.amount)}),t.actionMapper=s,t.items=a}).catch(a=>{console.log(a),c.showAlert(t,"Could not load the invoices.",k.ERROR)}).finally(()=>{t.loadingmsg=""})},showInvoiceReport:function(n){var t=this.$basedomainname+"invoices/"+n.invoiceNumber;window.open(t,"_blank")}},components:{CAlert:w}},z=Object.assign(E,{__name:"Invoices",setup(n){return(t,s)=>{const a=f("RouterLink");return u(),v(b,null,{default:p(()=>[o("div",I,[o("div",N,[R,o("div",M,[d(a,{to:"/invoice",class:"btn btn-outline-success"},{default:p(()=>[l(" Add"),S]),_:1})])]),i(o("div",null,[o("div",D,[l(r(t.loadingmsg)+" ",1),T])],512),[[h,t.loadingmsg]]),i(o("div",null,[d(w,{msg:t.alertmsg,mode:t.alertmode},null,8,["msg","mode"]),o("form",B,[F,i(o("input",{type:"date",class:"form-control me-2","onUpdate:modelValue":s[0]||(s[0]=e=>t.datefrom=e)},null,512),[[m,t.datefrom]]),U,i(o("input",{type:"date",class:"form-control me-2","onUpdate:modelValue":s[1]||(s[1]=e=>t.dateto=e)},null,512),[[m,t.dateto]]),i(o("input",{class:"form-control me-2",type:"search","onUpdate:modelValue":s[2]||(s[2]=e=>t.searchkeyword=e),placeholder:"Search","aria-label":"Search"},null,512),[[m,t.searchkeyword]]),o("button",{class:"btn btn-outline-success",type:"submit",onClick:s[3]||(s[3]=(...e)=>t.loadItems&&t.loadItems(...e))},"Search")]),d(V,{onViewClick:t.showInvoiceReport,items:t.items,columns:t.columns,allowaction:t.allowaction,actionmapper:t.actionMapper,actionmapperidentifier:"invoiceNumber"},null,8,["onViewClick","items","columns","allowaction","actionmapper"]),t.items&&t.items.length>0?(u(),A("div",L,[o("div",O,[o("strong",null,r(t.items.length),1),l(" record(s).")]),o("div",$,[l("Total Weight:"),o("strong",null,r(g(c).getAsFormattedAmount(t.totals.weight)),1)]),o("div",j,[l("Total Amount: "),o("strong",null,r(g(c).getAsFormattedAmount(t.totals.amount)),1)])])):C("",!0)],512),[[h,!t.loadingmsg]])])]),_:1})}}});export{z as default};
