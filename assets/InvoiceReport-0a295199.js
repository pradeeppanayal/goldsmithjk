import{o as d,c as u,a as t,t as n,w as i,v as a,F as h,r as g,b as p,u as f,d as l,e as c,f as A,A as v}from"./index-a9977b16.js";import{C as b,s as F,i as $,c as y}from"./dao-0a59864c.js";import{S as w,A as C}from"./ApplicationConstants-909446ca.js";import{_ as r}from"./CAlert-49effe02.js";const k={class:"table"},W=t("th",{scope:"col"},"Sl. No",-1),I=t("th",{scope:"col"},"Item",-1),T=t("th",{scope:"col"},"Weight",-1),S=t("th",{scope:"col"},"Purity",-1),D=t("th",{scope:"col"},"Pure Weight",-1),N=t("th",{scope:"col"},"Making Rate",-1),M=t("th",{scope:"col"},"Making Amount",-1),B=t("th",{scope:"col"},"Metal Amount",-1),R=t("th",{scope:"col"},"Taxable Amount",-1),P={scope:"col"},V=t("th",{scope:"col"},"Total Amount",-1),O={scope:"col"},L={key:0},j=["onClick"],U=t("th",{scope:"col"},"Total",-1),z=t("th",{scope:"col"},null,-1),E={scope:"col"},G=t("th",{scope:"col"},null,-1),H={scope:"col"},q=t("th",{scope:"col"},null,-1),J={scope:"col"},K={scope:"col"},Q={scope:"col"},X={scope:"col"},Y={scope:"col"},Z={scope:"col"},x={class:"table",style:{"text-align":"end"}},tt={style:{border:"1px solid #ccc"}},et=t("td",null,null,-1),ot=t("th",null,"Total Amount of Making Charge ",-1),nt={style:{border:"1px solid #ccc"}},lt={style:{border:"1px solid #ccc"}},st=t("td",null,null,-1),it={style:{border:"1px solid #ccc"}},at={style:{border:"1px solid #ccc"}},dt=t("td",null,null,-1),ut=t("th",null,"Metal Charge",-1),ct={style:{border:"1px solid #ccc"}},ht={style:{border:"1px solid #ccc"}},rt=t("td",null,null,-1),mt=t("th",null,"Total Amount",-1),_t={style:{border:"1px solid #ccc"}},gt=t("td",{style:{border:"1px solid #ccc"}},"Total Amount in Words ",-1),pt={style:{border:"1px solid #ccc"},colspan:"2"},ft={props:["invoiceinfo","allowdelete","fraction_digits","updatecount"],emits:["rowdelete","totals"],data:function(){return{default_fraction_digits:3,rowNo:0,itemsWithCalculatedFields:[],totals:[]}},watch:{updatecount:function(){this.populateDynamicFields()}},mounted:function(){this.populateDynamicFields()},methods:{populateDynamicFields:function(){this.populateCalculatedFields(),this.populateTotals()},asFixed:function(o){return o&&o.toLocaleString("en-US",{minimumFractionDigits:this.default_fraction_digits,maximumFractionDigits:this.default_fraction_digits})},populateCalculatedFields:function(){if(this.itemsWithCalculatedFields=[],!(!this.invoiceinfo||!this.invoiceinfo.items||this.invoiceinfo.items.length==0))for(let e of this.invoiceinfo.items){var o={...e};o.actualItme=e,this.populateCalculatedFieldsByItem(o),this.itemsWithCalculatedFields.push(o)}},populateCalculatedFieldsByItem:function(o){o.pureWeight=o.purity/1e3*o.weight,o.makingAmount=o.making*o.weight,o.metalAmount=this.invoiceinfo.rate*o.pureWeight,o.taxableAmount=o.making*o.weight,o.vatAmount=this.invoiceinfo.vat/100*o.taxableAmount,o.totalAmount=o.metalAmount+o.makingAmount+o.vatAmount},populateTotals:function(){var o={weight:0,pureWeight:0,makingAmount:0,taxableAmount:0,metalAmount:0,vatAmount:0,totalAmount:0};if(!(!this.itemsWithCalculatedFields||this.itemsWithCalculatedFields.length==0)){for(let e of this.itemsWithCalculatedFields)o.weight+=e.weight,o.pureWeight+=e.pureWeight,o.makingAmount+=e.makingAmount,o.taxableAmount+=e.taxableAmount,o.metalAmount+=e.metalAmount,o.vatAmount+=e.vatAmount,o.totalAmount+=e.totalAmount;this.totals=o,this.$emit("totals",o)}},getPureWeight:function(o){return o.purity/1e3*o.weight},getMakingAmount:function(o){return o.making*o.weight},getMetalAmount:function(o){return this.invoiceinfo.rate*this.getPureWeight(o)},getTaxableAmount:function(o){return o.making*o.weight},getVATAmount:function(o){return this.invoiceinfo.vat/100*this.getTaxableAmount(o)},getTotalAmountPerItem:function(o){return this.getMetalAmount(o)+this.getMakingAmount(o)+this.getVATAmount(o)}}},At=Object.assign(ft,{__name:"InvoiceItemTable",setup(o){return(e,m)=>(d(),u(h,null,[t("table",k,[t("thead",null,[t("tr",null,[W,I,T,S,D,N,M,B,R,t("th",P,"VAT Amount ("+n(o.invoiceinfo.vat)+"%)",1),V,i(t("th",O,"Actions",512),[[a,o.allowdelete]])])]),e.itemsWithCalculatedFields&&e.itemsWithCalculatedFields.length>0?(d(),u("tbody",L,[(d(!0),u(h,null,g(e.itemsWithCalculatedFields,(s,_)=>(d(),u("tr",null,[t("td",null,n(_+1),1),t("td",null,n(s.name),1),t("td",null,n(e.asFixed(s.weight)),1),t("td",null,n(e.asFixed(s.purity)),1),t("td",null,n(e.asFixed(s.pureWeight)),1),t("td",null,n(e.asFixed(s.making)),1),t("td",null,n(e.asFixed(s.makingAmount)),1),t("td",null,n(e.asFixed(s.metalAmount)),1),t("td",null,n(e.asFixed(s.taxableAmount)),1),t("td",null,n(e.asFixed(s.vatAmount)),1),t("td",null,n(e.asFixed(s.totalAmount)),1),i(t("td",null,[i(t("button",{class:"btn btn-outline-danger material-icons",onClick:oe=>e.$emit("rowdelete",s.actualItme)},"delete",8,j),[[a,o.allowdelete]])],512),[[a,o.allowdelete]])]))),256)),i(t("tr",null,[U,z,t("th",E,n(e.asFixed(e.totals.weight)),1),G,t("th",H,n(e.asFixed(e.totals.pureWeight)),1),q,t("th",J,n(e.asFixed(e.totals.makingAmount)),1),t("th",K,n(e.asFixed(e.totals.metalAmount)),1),t("th",Q,n(e.asFixed(e.totals.taxableAmount)),1),t("th",X,n(e.asFixed(e.totals.vatAmount)),1),t("th",Y,n(e.asFixed(e.totals.totalAmount)),1),i(t("th",Z,null,512),[[a,o.allowdelete]])],512),[[a,e.totals]])])):p("",!0)]),i(t("table",x,[t("tr",tt,[et,ot,t("th",nt,n(e.asFixed(e.totals.makingAmount)),1)]),t("tr",lt,[st,t("th",null,"Total VAT on Making Charge @"+n(o.invoiceinfo.vat)+"%",1),t("th",it,n(e.asFixed(e.totals.vatAmount)),1)]),t("tr",at,[dt,ut,t("th",ct,n(e.asFixed(e.totals.metalAmount)),1)]),t("tr",ht,[rt,mt,t("th",_t,n(e.asFixed(e.totals.totalAmount)),1)]),t("tr",null,[gt,t("td",pt,[t("b",null,n(f(b).doConvert(e.totals.totalAmount)),1)])])],512),[[a,e.totals&&e.itemsWithCalculatedFields&&e.itemsWithCalculatedFields.length>0]])],64))}});const vt={class:"text-center"},bt=t("div",{class:"spinner-grow",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")],-1),Ft={key:0},$t=t("h3",null,"No invoice found. ",-1),yt={key:1},wt={class:"invoice-box"},Ct={cellpadding:"0",cellspacing:"0"},kt={class:"top_rw"},Wt={colspan:"2"},It={style:{"margin-bottom":"0px"}},Tt={style:{width:"30%","margin-right":"10px"}},St=t("br",null,null,-1),Dt={class:"top"},Nt={colspan:"3"},Mt=t("br",null,null,-1),Bt={style:{}},Rt=t("br",null,null,-1),Pt=t("br",null,null,-1),Vt=t("br",null,null,-1),Ot={colspan:"3"},Lt=t("td",null,[t("b",null,"Accounts Copy")],-1),jt={style:{"text-align":"end"}},Ut={style:{"text-align":"end",width:"150px"}},zt={colspan:"3"},Et=t("tr",{class:"total"},null,-1),Gt={colspan:"3"},Ht={cellspacing:"0px",cellpadding:"2px"},qt=t("tr",null,[t("td",{width:"100%"},[t("b",null," Declaration: "),l(),t("br"),l(" We declare that this invoice shows the actual price of the goods described above and that all particulars are true and correct. The goods sold are intended for end user consumption and not for resale. ")])],-1),Jt={width:"50%"},Kt=t("br",null,null,-1),Qt=t("b",null," Customer Signature ",-1),Xt=t("br",null,null,-1),Yt=t("br",null,null,-1),Zt=t("br",null,null,-1),xt=t("br",null,null,-1),te=t("td",null,[t("b",null," Authorized Signature "),t("br"),t("br"),l(" ................................... "),t("br"),t("br"),t("br")],-1),ee={data:function(){return{invoice:{},updatecount:1,fraction_digits:2,allowdelete:!1,invoiceSettings:{},loadingmsg:"",alertmode:"",alertmsg:"",customer:{}}},mounted:function(){this.checkAndLoadInvoice(),this.loadInvoiceSettings()},methods:{loadInvoiceSettings:function(){var o=this;F.getById(w.APPLICATION_SETTINGS).then(e=>{o.invoiceSettings=e})},checkAndLoadInvoice:function(){var o=this;o.loadingmsg="Fetching invoice details...",$.getById(this.$route.params.invoicenumber).then(e=>{o.invoice=e,o.loadCustomer(),o.updatecount+=1}).catch(e=>{console.log(e),o.alertmode=C.ERROR,o.alertmsg="Could not fetch the invoice details"}).finally(()=>{o.loadingmsg=""})},loadCustomer:function(){var o=this;y.getById(this.invoice.customerId).then(e=>{o.customer=e})}},components:{CAlert:r}},ae=Object.assign(ee,{__name:"InvoiceReport",setup(o){return(e,m)=>(d(),u(h,null,[i(t("div",null,[t("div",vt,[l(n(e.loadingmsg)+" ",1),bt])],512),[[a,e.loadingmsg]]),i(t("div",null,[c(r,{msg:e.alertmsg,mode:e.alertmode},null,8,["msg","mode"]),e.invoice?(d(),u("div",yt,[t("div",wt,[t("table",Ct,[t("tr",kt,[t("td",Wt,[t("h2",It,n(e.invoiceSettings.invoiceHeader),1)]),t("td",Tt,[l(" Invoice Number: "+n(e.invoice.invoiceNumber)+" ",1),St,l("Purchase Date: "+n(e.invoice.purchaseDate),1)])]),t("tr",Dt,[t("td",Nt,[t("table",null,[t("tr",null,[t("td",null,[t("b",null," Sold By: "+n(e.$appname),1),l(),Mt,t("pre",null,n(e.invoiceSettings.companyAddress),1),t("span",Bt,"TRN: "+n(e.invoiceSettings.trn),1)]),i(t("td",null,[t("b",null," Billing Address: "+n(e.customer.Name),1),Rt,l(" "+n(e.customer.Address),1),Pt,l(" "+n(e.customer.Contact),1),Vt,l(" "+n(e.customer.TRN),1)],512),[[a,e.customer]])])])])]),t("tr",null,[t("td",Ot,[t("table",null,[t("tr",null,[Lt,t("td",jt,[t("b",null,"Metal Rate: "+n(e.invoice.rate),1)]),t("td",Ut,[t("b",null," Currency : "+n(e.invoiceSettings.currency),1)])])])])]),t("td",zt,[c(At,{invoiceinfo:e.invoice,fraction_digits:e.invoiceSettings.fractionDigits,allowdelete:e.allowdelete,updatecount:e.updatecount},null,8,["invoiceinfo","fraction_digits","allowdelete","updatecount"])]),Et,t("tr",null,[t("td",Gt,[t("table",Ht,[qt,t("tr",null,[t("td",Jt,[l(" Confirmed on behalf of "),t("b",null,n(e.invoice.customer),1),Kt,Qt,Xt,l(" ................................... "),Yt,Zt,xt]),te])])])])])])])):(d(),u("div",Ft,[c(v,null,{default:A(()=>[$t]),_:1})]))],512),[[a,!e.loadingmsg]])],64))}});export{ae as default};
