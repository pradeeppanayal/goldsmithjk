import{d as m,o as u,h as p,i as l,j as h,D as g,A as f,b as t,f as i,m as c,w as r,e as d,t as w}from"./index-1fb12b34.js";import{_ as v}from"./DynamicTable-fbe5af17.js";import{_ as y}from"./CAlert-d3554d48.js";const b={class:"pricing-header p-3 pb-md-4 mx-auto text-center"},R={class:"row"},k=t("div",{class:"col"},[t("div",{class:"mb-3 row text-start"},[t("div",{class:"col-sm-10"},[t("span",{class:"display-6 fw-normal"},"Gold Transactions")])])],-1),D={class:"col text-end"},N=t("span",{class:"material-icons"},"add",-1),A={class:"text-center"},C=t("div",{class:"spinner-grow",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")],-1),M={data:function(){return{items:[],columns:[{name:"receiptNumber",show:!0},{name:"paymentDate",show:!0,type:"date"},{name:"customer",show:!0},{name:"weight",show:!0,type:"amount"},{name:"purity",show:!0,type:"amount"},{name:"pureWeight",show:!0,type:"amount"},{name:"description",show:!0}],allowaction:!0,actions:[],actionMapper:[],loadingmsg:"",alertmode:"",alertmsg:"",datefrom:"",dateto:""}},mounted:function(){this.loadDates(),this.loadPayments()},methods:{loadDates:function(){},loadPayments:function(a){a&&a.preventDefault();var e=this;e.loadingmsg="Fetching transactions";var n={};g.list(this.datefrom,this.dateto).then(o=>{_.each(o,function(s){s.pureWeight=s.weight*(s.purity/1e3),n[s.id]=e.actions}),e.actionMapper=n,e.items=o}).catch(o=>{console.log(o),e.alertmode=f.ERROR,e.alertmsg="Could not fetch details"}).finally(()=>{e.loadingmsg=""})},showReceipt:function(a){if(a.weight>0){var e=this.$basedomainname+"goldtransaction/"+a.receiptNumber;window.open(e,"_blank")}else if(a.invoiceRef){var e=this.$basedomainname+"invoices/"+a.invoiceRef;window.open(e,"_blank")}}}},B=Object.assign(M,{__name:"GoldTransactions",setup(a){return(e,n)=>{const o=m("RouterLink");return u(),p(h,null,{default:l(()=>[t("div",b,[t("div",R,[k,t("div",D,[i(o,{to:"/goldtransaction",class:"btn btn-outline-success"},{default:l(()=>[c(" Add"),N]),_:1})])]),r(t("div",null,[t("div",A,[c(w(e.loadingmsg)+" ",1),C])],512),[[d,e.loadingmsg]]),r(t("div",null,[i(y,{msg:e.alertmsg,mode:e.alertmode},null,8,["msg","mode"]),i(v,{onViewClick:e.showReceipt,items:e.items,columns:e.columns,allowaction:e.allowaction,actionmapper:e.actionMapper,actionmapperidentifier:"invoiceNum"},null,8,["onViewClick","items","columns","allowaction","actionmapper"])],512),[[d,!e.loadingmsg]])])]),_:1})}}});export{B as default};
